<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="theme-color" content="#f8f5ec"><meta name="msapplication-navbutton-color" content="#f8f5ec"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec"><meta name="referrer" content="same-origin"><meta name="referrer" content="no-referrer"><meta name="description" content="HQL必会50题"><meta name="keywords" content="技术博客"><link rel="alternate" href="/cn/atom.xml" title="马攀的技术栈"><link rel="shortcut icon" type="image/x-icon" href="/cn/favicon.ico?v=2.11.0"><link rel="canonical" href="https://mapan.tech/cn/b8f1.html"><link rel="stylesheet" type="text/css" href="/cn/css/style.css?v=2.11.0"><script>window.config={toc:!0,fancybox:!1,pjax:!1,latex:!1}</script><title>HQL必会50题 - 马攀的技术栈</title></head><body><div id="mobile-navbar" class="mobile-navbar"><div class="mobile-header-logo"><a href="/cn/." class="logo">马攀的技术栈</a></div><div class="mobile-navbar-icon"><span></span> <span></span> <span></span></div></div><nav id="mobile-menu" class="mobile-menu slideout-menu"><ul class="mobile-menu-list"><a href="/cn/"><li class="mobile-menu-item">首页</li></a><a href="/cn/categories.html"><li class="mobile-menu-item">分类</li></a><a href="/cn/about.html"><li class="mobile-menu-item">关于</li></a><a href="/cn/message.html"><li class="mobile-menu-item">留言</li></a><a href="/cn/links.html"><li class="mobile-menu-item">友链</li></a></ul></nav><div class="container" id="mobile-panel"><header id="header" class="header"><div class="logo-wrapper"><a href="https://mapan.tech" class="logo">马攀的技术栈</a></div><nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item"><a class="menu-item-link" href="/cn/">首页</a></li><li class="menu-item"><a class="menu-item-link" href="/cn/categories.html">分类</a></li><li class="menu-item"><a class="menu-item-link" href="/cn/about.html">关于</a></li><li class="menu-item"><a class="menu-item-link" href="/cn/message.html">留言</a></li><li class="menu-item"><a class="menu-item-link" href="/cn/links.html">友链</a></li></ul></nav></header><main id="main" class="main"><div class="content-wrapper"><div id="content" class="content"><article class="post"><header class="post-header"><h1 class="post-title">HQL必会50题</h1><div class="post-meta"><span class="post-time">2020-03-17 </span><span class="post-category"><a href="/cn/categories/SQL/">SQL</a> </span><span id="/cn/b8f1.html" class="leancloud-visitors" data-flag-title="HQL必会50题">阅读数 <span class="leancloud-visitors-count">1000</span> </span><span class="post-count">字数统计 1.9k </span><span class="post-count">阅读时长 8</span></div></header><div class="post-content"><p>平常加班不多，为了提高自己的SQL能力，找了网上流传的比较广泛的SQL50题，先把题目拿过来，计划抽空作为练习用HiveSQL完成。<br>建表语句</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(s_id <span class="keyword">string</span>,s_name <span class="keyword">string</span>,s_birth <span class="keyword">string</span>,s_sex <span class="keyword">string</span>) <span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> course(c_id <span class="keyword">string</span>,c_name <span class="keyword">string</span>,t_id <span class="keyword">string</span>) <span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> teacher(t_id <span class="keyword">string</span>,t_name <span class="keyword">string</span>) <span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> score(s_id <span class="keyword">string</span>,c_id <span class="keyword">string</span>,s_score <span class="built_in">int</span>) <span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\t'</span>;</span><br></pre></td></tr></table></figure><p>数据：</p><p>student.txt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">01	赵雷	1990-01-01	男</span><br><span class="line">02	钱电	1990-12-21	男</span><br><span class="line">03	孙风	1990-05-20	男</span><br><span class="line">04	李云	1990-08-06	男</span><br><span class="line">05	周梅	1991-12-01	女</span><br><span class="line">06	吴兰	1992-03-01	女</span><br><span class="line">07	郑竹	1989-07-01	女</span><br><span class="line">08	王菊	1990-01-20	女</span><br></pre></td></tr></table></figure><p>teacher.txt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">01	张三</span><br><span class="line">02	李四</span><br><span class="line">03	王五</span><br></pre></td></tr></table></figure><p>course.txt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">01	语文	02</span><br><span class="line">02	数学	01</span><br><span class="line">03	英语	03</span><br></pre></td></tr></table></figure><p>socre.txt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">01	01	80</span><br><span class="line">01	02	90</span><br><span class="line">01	03	99</span><br><span class="line">02	01	70</span><br><span class="line">02	02	60</span><br><span class="line">02	03	80</span><br><span class="line">03	01	80</span><br><span class="line">03	02	80</span><br><span class="line">03	03	80</span><br><span class="line">04	01	50</span><br><span class="line">04	02	30</span><br><span class="line">04	03	20</span><br><span class="line">05	01	76</span><br><span class="line">05	02	87</span><br><span class="line">06	01	31</span><br><span class="line">06	03	34</span><br><span class="line">07	02	89</span><br><span class="line">07	03	98</span><br></pre></td></tr></table></figure><p>加载数据：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'~/student.txt'</span> <span class="keyword">into</span> <span class="keyword">table</span> student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'~/course.txt'</span> <span class="keyword">into</span> <span class="keyword">table</span> course;</span><br><span class="line"></span><br><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'~/teacher.txt'</span> <span class="keyword">into</span> <span class="keyword">table</span> teacher;</span><br><span class="line"></span><br><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'~/score.txt'</span> <span class="keyword">into</span> <span class="keyword">table</span> score;</span><br></pre></td></tr></table></figure><p>表之间的关系如图：</p><p><img src="/cn/b8f1/Kinship.png" alt="表关系"></p><ul><li>1、查询”01”课程比”02”课程成绩高的学生的信息及课程分数:</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    T0.*,</span><br><span class="line">    T1.s_score <span class="keyword">AS</span> c01,</span><br><span class="line">    T2.s_score <span class="keyword">as</span> c02</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    student <span class="keyword">AS</span> T0,</span><br><span class="line">    (<span class="keyword">SELECT</span> s_id,s_score <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> c_id=<span class="string">'01'</span>) <span class="keyword">AS</span> T1,</span><br><span class="line">    (<span class="keyword">SELECT</span> s_id,s_score <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> c_id=<span class="string">'02'</span>) <span class="keyword">AS</span> T2</span><br><span class="line"><span class="keyword">WHERE</span> T0.s_id=T1.s_id</span><br><span class="line"><span class="keyword">AND</span> T0.s_id=T2.s_id</span><br><span class="line"><span class="keyword">AND</span> T1.s_score&gt;T2.s_score;</span><br></pre></td></tr></table></figure><p>运行结果：</p><p><img src="/cn/b8f1/image-20200318221755774.png" alt="image-20200318221755774"></p><ul><li>2、查询同时存在” 01 “课程和” 02 “课程的情况:</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    t3.*,</span><br><span class="line">    t1.s_score <span class="keyword">as</span> c01,</span><br><span class="line">    t2.s_score <span class="keyword">as</span> c02</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">    (<span class="keyword">SELECT</span> s_id,s_score <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> c_id=<span class="string">'01'</span>) <span class="keyword">as</span> t1, <span class="comment">-- 选修01课程的同学</span></span><br><span class="line">    (<span class="keyword">SELECT</span> s_id,s_score <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> c_id=<span class="string">'02'</span>) <span class="keyword">as</span> t2, <span class="comment">-- 选修01课程的同学</span></span><br><span class="line">    student <span class="keyword">as</span> t3</span><br><span class="line"><span class="keyword">WHERE</span> t1.s_id=t2.s_id</span><br><span class="line"><span class="keyword">AND</span> t2.s_id=t3.s_id;</span><br></pre></td></tr></table></figure><p>运行结果：</p><p><img src="/cn/b8f1/image-20200318224041101.png" alt="image-20200318224041101"></p><ul><li>3、查询存在” 01 “课程但<strong>可能</strong>不存在” 02 “课程的情况(不存在时显示为 null )</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    t2.*,</span><br><span class="line">    t1.s_score <span class="keyword">AS</span> c01,</span><br><span class="line">    t3.s_score <span class="keyword">AS</span> c02 </span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    (<span class="keyword">SELECT</span> s_id,s_score <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> c_id=<span class="string">'01'</span>) <span class="keyword">AS</span> t1, <span class="comment">-- 选修01课程的同学</span></span><br><span class="line">    student <span class="keyword">AS</span> t2</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> s_id,s_score <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> c_id=<span class="string">'02'</span>) <span class="keyword">AS</span> t3 <span class="comment">-- 选修01课程的同学</span></span><br><span class="line"><span class="keyword">ON</span> t2.s_id = t3.s_id</span><br><span class="line"><span class="keyword">WHERE</span> t1.s_id=t2.s_id;</span><br></pre></td></tr></table></figure><p>运行结果：<br><img src="/cn/b8f1/image-20200318225024279.png" alt="image-20200318225024279"></p><ul><li>4、查询平均成绩小于60分的同学的学生编号和学生姓名和平均成绩:<br>(包括有成绩的和无成绩的)</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    T1.s_id,</span><br><span class="line">    T1.s_name,</span><br><span class="line">    T2.avg_sc</span><br><span class="line"><span class="keyword">FROM</span> student <span class="keyword">AS</span> T1</span><br><span class="line"><span class="keyword">JOIN</span>(<span class="keyword">SELECT</span></span><br><span class="line">        s_id,</span><br><span class="line">        <span class="keyword">avg</span>(s_score) <span class="keyword">AS</span> avg_sc </span><br><span class="line">    <span class="keyword">FROM</span> score</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> s_id</span><br><span class="line">    <span class="keyword">having</span> avg_sc&lt;<span class="number">60</span>) <span class="keyword">AS</span> T2</span><br><span class="line"><span class="keyword">ON</span> T1.s_id=T2.s_id;</span><br></pre></td></tr></table></figure><p>运行结果：</p><p><img src="/cn/b8f1/image-20200318225822830.png" alt="image-20200318225822830"></p><ul><li>5、查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩:</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">SELECT</span></span><br><span class="line">      T1.s_id,</span><br><span class="line">      T1.s_name,</span><br><span class="line">      T2.co_cnt,</span><br><span class="line">      T3.sum_score</span><br><span class="line">  <span class="keyword">FROM</span> student <span class="keyword">AS</span> T1</span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> s_id,<span class="keyword">count</span>(<span class="number">1</span>) <span class="keyword">AS</span> co_cnt <span class="keyword">FROM</span> score <span class="keyword">GROUP</span> <span class="keyword">BY</span> s_id) <span class="keyword">AS</span> T2</span><br><span class="line">  <span class="keyword">ON</span> T1.s_id=T2.s_id</span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> s_id,<span class="keyword">sum</span>(s_score) <span class="keyword">AS</span> sum_score <span class="keyword">FROM</span> score <span class="keyword">GROUP</span> <span class="keyword">BY</span> s_id) <span class="keyword">AS</span> T3</span><br><span class="line"><span class="keyword">ON</span> T1.s_id=T3.s_id;</span><br></pre></td></tr></table></figure><p>运行结果：</p><p><img src="/cn/b8f1/image-20200318231242423.png" alt="image-20200318231242423"></p><ul><li>6、查询”李”姓老师的数量:</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="number">1</span>) <span class="keyword">FROM</span> teacher <span class="keyword">WHERE</span> t_name <span class="keyword">LIKE</span> <span class="string">"李%"</span>;</span><br></pre></td></tr></table></figure><p><img src="/cn/b8f1/image-20200319073738350.png" alt="image-20200319073738350"></p><ul><li>7、查询学过”张三”老师授课的同学的信息:</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">SELECT</span> </span><br><span class="line">      T1.*,</span><br><span class="line">      T3.c_name,</span><br><span class="line">      T4.t_name</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">      student <span class="keyword">AS</span> T1,</span><br><span class="line">      score <span class="keyword">AS</span> T2,</span><br><span class="line">      course <span class="keyword">AS</span> T3,</span><br><span class="line">      teacher <span class="keyword">AS</span> T4</span><br><span class="line">  <span class="keyword">WHERE</span> T1.s_id=T2.s_id</span><br><span class="line">  <span class="keyword">AND</span> T2.c_id=T3.c_id</span><br><span class="line">  <span class="keyword">AND</span> T3.t_id=T4.t_id</span><br><span class="line"><span class="keyword">AND</span> T4.t_name=<span class="string">"张三"</span>;</span><br></pre></td></tr></table></figure><p>运行结果：</p><p><img src="/cn/b8f1/image-20200319074432715.png" alt="image-20200319074432715"></p><ul><li>8、查询没学过”张三”老师授课的同学的信息:</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">SELECT</span> A1.* <span class="keyword">FROM</span> student <span class="keyword">AS</span> A1</span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span>(<span class="keyword">SELECT</span> </span><br><span class="line">                  T1.s_id</span><br><span class="line">              <span class="keyword">FROM</span></span><br><span class="line">                  student <span class="keyword">AS</span> T1,</span><br><span class="line">                  score <span class="keyword">AS</span> T2,</span><br><span class="line">                  course <span class="keyword">AS</span> T3,</span><br><span class="line">                  teacher <span class="keyword">AS</span> T4</span><br><span class="line">              <span class="keyword">WHERE</span> T1.s_id=T2.s_id</span><br><span class="line">              <span class="keyword">AND</span> T2.c_id=T3.c_id</span><br><span class="line">              <span class="keyword">AND</span> T3.t_id=T4.t_id</span><br><span class="line">              <span class="keyword">AND</span> T4.t_name=<span class="string">"张三"</span>) <span class="keyword">AS</span> A2</span><br><span class="line">  <span class="keyword">ON</span> A1.s_id=A2.s_id</span><br><span class="line"><span class="keyword">WHERE</span> A2.s_id <span class="keyword">IS</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure><p>运行结果：</p><p><img src="/cn/b8f1/image-20200319075846289.png" alt="image-20200319075846289"></p><ul><li>9、查询学过编号为”01”并且也学过编号为”02”的课程的同学的信息:</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">SELECT</span> A.* </span><br><span class="line">  <span class="keyword">FROM</span> student <span class="keyword">AS</span> A</span><br><span class="line">  <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span></span><br><span class="line">              T1.s_id</span><br><span class="line">          <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> s_id <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> c_id=<span class="string">'01'</span>) <span class="keyword">AS</span> T1</span><br><span class="line">          <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> s_id <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> c_id=<span class="string">'02'</span>) <span class="keyword">AS</span> T2</span><br><span class="line">          <span class="keyword">ON</span> T1.s_id=T2.s_id) <span class="keyword">AS</span> B</span><br><span class="line"><span class="keyword">ON</span> A.s_id=B.s_id;</span><br></pre></td></tr></table></figure><p>运行结果：</p><p><img src="/cn/b8f1/image-20200319080655329.png" alt="image-20200319080655329"></p><ul><li>10、查询学过编号为”01”但是没有学过编号为”02”的课程的同学的信息:</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">SELECT</span> A.* </span><br><span class="line">  <span class="keyword">FROM</span> student <span class="keyword">AS</span> A</span><br><span class="line">  <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span></span><br><span class="line">              T1.s_id</span><br><span class="line">          <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> s_id <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> c_id=<span class="string">'01'</span>) <span class="keyword">AS</span> T1</span><br><span class="line">          <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> s_id <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> c_id=<span class="string">'02'</span>) <span class="keyword">AS</span> T2</span><br><span class="line">          <span class="keyword">ON</span> T1.s_id=T2.s_id</span><br><span class="line">          <span class="keyword">WHERE</span> T2.s_id <span class="keyword">IS</span> <span class="literal">NULL</span>) <span class="keyword">AS</span> B</span><br><span class="line"><span class="keyword">ON</span> A.s_id=B.s_id;</span><br></pre></td></tr></table></figure><p>运行结果：</p><p><img src="/cn/b8f1/image-20200319080957865.png" alt="image-20200319080957865"></p><p>正在更新中…</p><hr><ul><li>11、查询没有学全所有课程的同学的信息:</li></ul><ul><li>12、查询至少有一门课与学号为”01”的同学所学相同的同学的信息:</li></ul><ul><li>13、查询和”01”号的同学学习的课程完全相同的其他同学的信息:</li></ul><ul><li>14、查询没学过”张三”老师讲授的任一门课程的学生姓名:</li></ul><ul><li>15、查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩:</li></ul><ul><li>16、检索”01”课程分数小于60，按分数降序排列的学生信息:</li></ul><ul><li>17、按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩:</li></ul><ul><li>18.查询各科成绩最高分、最低分和平均分：以如下形式显示：课程ID，课程name，最高分，最低分，平均分，及格率，中等率，优良率，优秀率: （及格为&gt;=60，中等为：70-80，优良为：80-90，优秀为：&gt;=90）</li></ul><ul><li>19、按各科成绩进行排序，并显示排名:</li></ul><ul><li>20、查询学生的总成绩并进行排名:</li></ul><ul><li>21、查询不同老师所教不同课程平均分从高到低显示:</li></ul><ul><li>22、查询所有课程的成绩第2名到第3名的学生信息及该课程成绩:</li></ul><ul><li>23、统计各科成绩各分数段人数：课程编号,课程名称,[100-85],[85-70],[70-60],[0-60]及所占百分比</li></ul><ul><li>24、查询学生平均成绩及其名次:</li></ul><ul><li>25、查询各科成绩前三名的记录</li></ul><ul><li>26、查询每门课程被选修的学生数:</li></ul><ul><li>27、查询出只有两门课程的全部学生的学号和姓名:</li></ul><ul><li>28、查询男生、女生人数:</li></ul><ul><li>29、查询名字中含有”风”字的学生信息:</li></ul><ul><li>30、查询同名同性学生名单，并统计同名人数:</li></ul><ul><li>31、查询1990年出生的学生名单:</li></ul><ul><li>32、查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同时，按课程编号升序排列:</li></ul><ul><li>33、查询平均成绩大于等于85的所有学生的学号、姓名和平均成绩:</li></ul><ul><li>34、查询课程名称为”数学”，且分数低于60的学生姓名和分数:</li></ul><ul><li>35、查询所有学生的课程及分数情况:</li></ul><ul><li>36、查询任何一门课程成绩在70分以上的学生姓名、课程名称和分数:</li></ul><ul><li>37、查询课程不及格的学生:</li></ul><ul><li>38、查询课程编号为01且课程成绩在80分以上的学生的学号和姓名:</li></ul><ul><li>39、求每门课程的学生人数:</li></ul><ul><li>40、查询选修”张三”老师所授课程的学生中，成绩最高的学生信息及其成绩:</li></ul><ul><li>41、查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩:</li></ul><ul><li>42、查询每门课程成绩最好的前三名:</li></ul><ul><li>43、统计每门课程的学生选修人数（超过5人的课程才统计）:要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列</li></ul><ul><li>44、检索至少选修两门课程的学生学号:</li></ul><ul><li>45、查询选修了全部课程的学生信息:</li></ul><ul><li>46、查询各学生的年龄(周岁):</li></ul><ul><li>47、查询本周过生日的学生:</li></ul><ul><li>48、查询下周过生日的学生:</li></ul><ul><li>49、查询本月过生日的学生:</li></ul><ul><li>50、查询12月份过生日的学生:</li></ul></div><div class="post-copyright"><p class="copyright-item"><span>原文作者: </span><a href="https://mapan.tech/cn">MaPan</a></p><p class="copyright-item"><span>原文链接: </span><a href="https://mapan.tech/cn/b8f1.html">https://mapan.tech/cn/b8f1.html</a></p><p class="copyright-item"><span>许可协议: </span><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a></p></div><footer class="post-footer"><nav class="post-nav"><a class="next" href="/cn/f8df.html"><span class="next-text nav-default">归并排序</span> <span class="prev-text nav-mobile">下一篇</span> <i class="iconfont icon-right"></i></a></nav></footer></article></div><div class="comments" id="comments"><div id="vcomments"></div></div></div></main><footer id="footer" class="footer"><div class="social-links"><a href="/cn/atom.xml" class="iconfont icon-rss" title="rss" target="_blank"></a></div><div class="copyright"><span class="division">&nbsp;</span><span class="post-count"> 全站字数 71.3k </span><span class="copyright-year">Since 2015 <span class="heart"><i class="iconfont icon-heart"></i> </span><span class="author">MaPan</span></span></div></footer><div class="back-to-top" id="back-to-top"><i class="iconfont icon-up"></i></div></div><script src="./lib/valine/av-min.js?v=3.0.4"></script><script src="./lib/valine/Valine.min.js"></script><script type="text/javascript">new Valine({el:"#vcomments",notify:!1,verify:!0,app_id:"XtxvAXPwOzM9noIc3eyxi3AS-gzGzoHsz",app_key:"yEVQszyxb4bwLuAGU5VHnPR8",placeholder:"说点什么吧...",avatar:"mm",visitor:"ture"})</script><script type="text/javascript" src="/cn/lib/jquery/jquery.min.js"></script><script type="text/javascript" src="/cn/lib/slideout/slideout.js"></script><script type="text/javascript" src="/cn/js/src/even.js?v=2.11.0"></script></body></html>